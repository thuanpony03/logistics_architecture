2024-12-24 16:50:43,167 - __main__ - INFO - Starting logistics data pipeline
User: ponydasierra
Environment: development
Start Time (UTC): 2024-12-24 09:50:39.613338
2024-12-24 16:50:43,167 - __main__ - INFO - Starting data extraction phase
2024-12-24 16:50:43,167 - __main__ - INFO - Processing table: Orders
2024-12-24 16:50:43,167 - src.extract.mysql_extractor - INFO - Starting extraction of table Orders
2024-12-24 16:50:46,126 - src.extract.mysql_extractor - INFO - Completed extraction of Orders:
Records: 5,168
Partitions: 4
Duration: 2.58 seconds
2024-12-24 16:50:46,240 - src.load.datalake_loader - INFO - Starting raw zone load for Orders
2024-12-24 16:50:47,385 - src.load.datalake_loader - INFO - Completed raw zone load for Orders:
Records: 5,168
Partitioning: partitioned by ['created_at_partition', 'status']
Duration: 1.08 seconds
Path: hdfs://localhost:9000/user/thuanpony03/logistics/data/datalake/raw/Orders
2024-12-24 16:50:47,385 - __main__ - INFO - Completed Orders: 5,168 records processed in 4.22 seconds
2024-12-24 16:50:47,385 - __main__ - INFO - Processing table: Shipments
2024-12-24 16:50:47,385 - src.extract.mysql_extractor - INFO - Starting extraction of table Shipments
2024-12-24 16:50:47,517 - src.extract.mysql_extractor - INFO - Completed extraction of Shipments:
Records: 3,459
Partitions: 4
Duration: 0.05 seconds
2024-12-24 16:50:47,568 - src.load.datalake_loader - INFO - Starting raw zone load for Shipments
2024-12-24 16:50:47,811 - src.load.datalake_loader - INFO - Completed raw zone load for Shipments:
Records: 3,459
Partitioning: partitioned by ['status']
Duration: 0.19 seconds
Path: hdfs://localhost:9000/user/thuanpony03/logistics/data/datalake/raw/Shipments
2024-12-24 16:50:47,811 - __main__ - INFO - Completed Shipments: 3,459 records processed in 0.43 seconds
2024-12-24 16:50:47,811 - __main__ - INFO - Processing table: Payments
2024-12-24 16:50:47,811 - src.extract.mysql_extractor - INFO - Starting extraction of table Payments
2024-12-24 16:50:47,915 - src.extract.mysql_extractor - INFO - Completed extraction of Payments:
Records: 5,168
Partitions: 4
Duration: 0.04 seconds
2024-12-24 16:50:47,969 - src.load.datalake_loader - INFO - Starting raw zone load for Payments
2024-12-24 16:50:48,649 - src.load.datalake_loader - INFO - Completed raw zone load for Payments:
Records: 5,168
Partitioning: partitioned by ['payment_date_partition', 'payment_status']
Duration: 0.64 seconds
Path: hdfs://localhost:9000/user/thuanpony03/logistics/data/datalake/raw/Payments
2024-12-24 16:50:48,649 - __main__ - INFO - Completed Payments: 5,168 records processed in 0.84 seconds
2024-12-24 16:50:48,649 - __main__ - INFO - Processing table: Notifications
2024-12-24 16:50:48,649 - src.extract.mysql_extractor - INFO - Starting extraction of table Notifications
2024-12-24 16:50:48,738 - src.extract.mysql_extractor - INFO - Completed extraction of Notifications:
Records: 9,182
Partitions: 4
Duration: 0.04 seconds
2024-12-24 16:50:48,781 - src.load.datalake_loader - INFO - Starting raw zone load for Notifications
2024-12-24 16:50:49,430 - src.load.datalake_loader - INFO - Completed raw zone load for Notifications:
Records: 9,182
Partitioning: partitioned by ['notification_date_partition']
Duration: 0.59 seconds
Path: hdfs://localhost:9000/user/thuanpony03/logistics/data/datalake/raw/Notifications
2024-12-24 16:50:49,430 - __main__ - INFO - Completed Notifications: 9,182 records processed in 0.78 seconds
2024-12-24 16:50:49,430 - __main__ - INFO - Processing table: Users
2024-12-24 16:50:49,430 - src.extract.mysql_extractor - INFO - Starting extraction of table Users
2024-12-24 16:50:49,512 - src.extract.mysql_extractor - INFO - Completed extraction of Users:
Records: 1,000
Partitions: 1
Duration: 0.01 seconds
2024-12-24 16:50:49,567 - src.load.datalake_loader - INFO - Starting raw zone load for Users
2024-12-24 16:50:49,782 - src.load.datalake_loader - INFO - Completed raw zone load for Users:
Records: 1,000
Partitioning: not partitioned
Duration: 0.15 seconds
Path: hdfs://localhost:9000/user/thuanpony03/logistics/data/datalake/raw/Users
2024-12-24 16:50:49,783 - __main__ - INFO - Completed Users: 1,000 records processed in 0.35 seconds
2024-12-24 16:50:49,783 - __main__ - INFO - Processing table: Drivers
2024-12-24 16:50:49,783 - src.extract.mysql_extractor - INFO - Starting extraction of table Drivers
2024-12-24 16:50:49,867 - src.extract.mysql_extractor - INFO - Completed extraction of Drivers:
Records: 200
Partitions: 1
Duration: 0.01 seconds
2024-12-24 16:50:49,924 - src.load.datalake_loader - INFO - Starting raw zone load for Drivers
2024-12-24 16:50:50,135 - src.load.datalake_loader - INFO - Completed raw zone load for Drivers:
Records: 200
Partitioning: not partitioned
Duration: 0.16 seconds
Path: hdfs://localhost:9000/user/thuanpony03/logistics/data/datalake/raw/Drivers
2024-12-24 16:50:50,135 - __main__ - INFO - Completed Drivers: 200 records processed in 0.35 seconds
2024-12-24 16:50:50,135 - __main__ - INFO - Data extraction phase completed in 6.97 seconds
2024-12-24 16:50:50,135 - __main__ - INFO - Starting data transformation phase
2024-12-24 16:50:50,135 - src.transform.transform_executor - INFO - Starting transformation process
Timestamp: 2024-12-24 09:43:35
User: thuanpony03
2024-12-24 16:50:50,135 - src.transform.transform_executor - INFO - Starting dimension transformation at 2024-12-24 09:43:35
2024-12-24 16:50:50,135 - src.transform.dimension_builder - INFO - Building date dimension from 2024-01-01 to 2024-12-31
2024-12-24 16:50:50,332 - src.transform.dimension_builder - INFO - Successfully built date dimension with 366 rows
2024-12-24 16:50:50,456 - src.transform.dimension_builder - INFO - Building user dimension
2024-12-24 16:50:50,633 - src.transform.dimension_builder - INFO - Successfully built user dimension with 1000 rows
2024-12-24 16:50:50,673 - src.transform.dimension_builder - INFO - Building driver dimension
2024-12-24 16:50:50,835 - src.transform.dimension_builder - ERROR - Error building driver dimension: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `driver` cannot be resolved. Did you mean one of the following? [`driver_id`, `is_active`, `user_key`, `full_name`, `vehicle_year`].;
'Project [driver_id#608, user_key#578, full_name#532, vehicle_license_plate#610, vehicle_type#611, vehicle_year#612, is_active#673, effective_start_date#674, effective_end_date#675, row_number() windowspecdefinition('driver ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS driver_key#686]
+- Project [driver_id#608, user_key#578, full_name#532, vehicle_license_plate#610, vehicle_type#611, vehicle_year#612, true AS is_active#673, current_date(Some(Asia/Vientiane)) AS effective_start_date#674, to_date(9999-12-31, None, Some(Asia/Vientiane), false) AS effective_end_date#675]
   +- Project [driver_id#608, user_key#578, full_name#532, vehicle_license_plate#610, vehicle_type#611, vehicle_year#612]
      +- Join Inner, (user_id#609 = user_id#531)
         :- Relation [driver_id#608,user_id#609,vehicle_license_plate#610,vehicle_type#611,vehicle_year#612,dl_ingestion_timestamp#613,dl_source_table#614,dl_batch_id#615,dl_process_date#616] parquet
         +- Project [user_id#531, full_name#532, email#533, phone_number#535, address#536, role#543, created_at#538, is_active#564, effective_start_date#565, effective_end_date#566, user_key#578]
            +- Project [user_id#531, full_name#532, email#533, phone_number#535, address#536, role#543, created_at#538, is_active#564, effective_start_date#565, effective_end_date#566, _w0#580, user_key#578, user_key#578]
               +- Window [row_number() windowspecdefinition(_w0#580 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS user_key#578], [_w0#580 ASC NULLS FIRST]
                  +- Project [user_id#531, full_name#532, email#533, phone_number#535, address#536, role#543, created_at#538, is_active#564, effective_start_date#565, effective_end_date#566, current_user() AS _w0#580]
                     +- Project [user_id#531, full_name#532, email#533, phone_number#535, address#536, role#543, created_at#538, true AS is_active#564, coalesce(cast(created_at#538 as date), current_date(Some(Asia/Vientiane))) AS effective_start_date#565, to_date(9999-12-31, None, Some(Asia/Vientiane), false) AS effective_end_date#566]
                        +- Project [user_id#531, full_name#532, email#533, phone_number#535, address#536, role#543, created_at#538]
                           +- Project [user_id#531, full_name#532, email#533, password_hash#534, phone_number#535, address#536, staticinvoke(class org.apache.spark.sql.catalyst.util.CharVarcharCodegenUtils, StringType, readSidePadding, role#537, 6, true, false, true) AS role#543, created_at#538, dl_ingestion_timestamp#539, dl_source_table#540, dl_batch_id#541, dl_process_date#542]
                              +- Relation [user_id#531,full_name#532,email#533,password_hash#534,phone_number#535,address#536,role#537,created_at#538,dl_ingestion_timestamp#539,dl_source_table#540,dl_batch_id#541,dl_process_date#542] parquet

2024-12-24 16:50:50,837 - src.transform.transform_executor - ERROR - Error in dimension transformation: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `driver` cannot be resolved. Did you mean one of the following? [`driver_id`, `is_active`, `user_key`, `full_name`, `vehicle_year`].;
'Project [driver_id#608, user_key#578, full_name#532, vehicle_license_plate#610, vehicle_type#611, vehicle_year#612, is_active#673, effective_start_date#674, effective_end_date#675, row_number() windowspecdefinition('driver ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS driver_key#686]
+- Project [driver_id#608, user_key#578, full_name#532, vehicle_license_plate#610, vehicle_type#611, vehicle_year#612, true AS is_active#673, current_date(Some(Asia/Vientiane)) AS effective_start_date#674, to_date(9999-12-31, None, Some(Asia/Vientiane), false) AS effective_end_date#675]
   +- Project [driver_id#608, user_key#578, full_name#532, vehicle_license_plate#610, vehicle_type#611, vehicle_year#612]
      +- Join Inner, (user_id#609 = user_id#531)
         :- Relation [driver_id#608,user_id#609,vehicle_license_plate#610,vehicle_type#611,vehicle_year#612,dl_ingestion_timestamp#613,dl_source_table#614,dl_batch_id#615,dl_process_date#616] parquet
         +- Project [user_id#531, full_name#532, email#533, phone_number#535, address#536, role#543, created_at#538, is_active#564, effective_start_date#565, effective_end_date#566, user_key#578]
            +- Project [user_id#531, full_name#532, email#533, phone_number#535, address#536, role#543, created_at#538, is_active#564, effective_start_date#565, effective_end_date#566, _w0#580, user_key#578, user_key#578]
               +- Window [row_number() windowspecdefinition(_w0#580 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS user_key#578], [_w0#580 ASC NULLS FIRST]
                  +- Project [user_id#531, full_name#532, email#533, phone_number#535, address#536, role#543, created_at#538, is_active#564, effective_start_date#565, effective_end_date#566, current_user() AS _w0#580]
                     +- Project [user_id#531, full_name#532, email#533, phone_number#535, address#536, role#543, created_at#538, true AS is_active#564, coalesce(cast(created_at#538 as date), current_date(Some(Asia/Vientiane))) AS effective_start_date#565, to_date(9999-12-31, None, Some(Asia/Vientiane), false) AS effective_end_date#566]
                        +- Project [user_id#531, full_name#532, email#533, phone_number#535, address#536, role#543, created_at#538]
                           +- Project [user_id#531, full_name#532, email#533, password_hash#534, phone_number#535, address#536, staticinvoke(class org.apache.spark.sql.catalyst.util.CharVarcharCodegenUtils, StringType, readSidePadding, role#537, 6, true, false, true) AS role#543, created_at#538, dl_ingestion_timestamp#539, dl_source_table#540, dl_batch_id#541, dl_process_date#542]
                              +- Relation [user_id#531,full_name#532,email#533,password_hash#534,phone_number#535,address#536,role#537,created_at#538,dl_ingestion_timestamp#539,dl_source_table#540,dl_batch_id#541,dl_process_date#542] parquet

2024-12-24 16:50:50,839 - src.transform.transform_executor - ERROR - Transform process failed: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `driver` cannot be resolved. Did you mean one of the following? [`driver_id`, `is_active`, `user_key`, `full_name`, `vehicle_year`].;
'Project [driver_id#608, user_key#578, full_name#532, vehicle_license_plate#610, vehicle_type#611, vehicle_year#612, is_active#673, effective_start_date#674, effective_end_date#675, row_number() windowspecdefinition('driver ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS driver_key#686]
+- Project [driver_id#608, user_key#578, full_name#532, vehicle_license_plate#610, vehicle_type#611, vehicle_year#612, true AS is_active#673, current_date(Some(Asia/Vientiane)) AS effective_start_date#674, to_date(9999-12-31, None, Some(Asia/Vientiane), false) AS effective_end_date#675]
   +- Project [driver_id#608, user_key#578, full_name#532, vehicle_license_plate#610, vehicle_type#611, vehicle_year#612]
      +- Join Inner, (user_id#609 = user_id#531)
         :- Relation [driver_id#608,user_id#609,vehicle_license_plate#610,vehicle_type#611,vehicle_year#612,dl_ingestion_timestamp#613,dl_source_table#614,dl_batch_id#615,dl_process_date#616] parquet
         +- Project [user_id#531, full_name#532, email#533, phone_number#535, address#536, role#543, created_at#538, is_active#564, effective_start_date#565, effective_end_date#566, user_key#578]
            +- Project [user_id#531, full_name#532, email#533, phone_number#535, address#536, role#543, created_at#538, is_active#564, effective_start_date#565, effective_end_date#566, _w0#580, user_key#578, user_key#578]
               +- Window [row_number() windowspecdefinition(_w0#580 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS user_key#578], [_w0#580 ASC NULLS FIRST]
                  +- Project [user_id#531, full_name#532, email#533, phone_number#535, address#536, role#543, created_at#538, is_active#564, effective_start_date#565, effective_end_date#566, current_user() AS _w0#580]
                     +- Project [user_id#531, full_name#532, email#533, phone_number#535, address#536, role#543, created_at#538, true AS is_active#564, coalesce(cast(created_at#538 as date), current_date(Some(Asia/Vientiane))) AS effective_start_date#565, to_date(9999-12-31, None, Some(Asia/Vientiane), false) AS effective_end_date#566]
                        +- Project [user_id#531, full_name#532, email#533, phone_number#535, address#536, role#543, created_at#538]
                           +- Project [user_id#531, full_name#532, email#533, password_hash#534, phone_number#535, address#536, staticinvoke(class org.apache.spark.sql.catalyst.util.CharVarcharCodegenUtils, StringType, readSidePadding, role#537, 6, true, false, true) AS role#543, created_at#538, dl_ingestion_timestamp#539, dl_source_table#540, dl_batch_id#541, dl_process_date#542]
                              +- Relation [user_id#531,full_name#532,email#533,password_hash#534,phone_number#535,address#536,role#537,created_at#538,dl_ingestion_timestamp#539,dl_source_table#540,dl_batch_id#541,dl_process_date#542] parquet

2024-12-24 16:50:50,841 - __main__ - ERROR - Error in transformation phase: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `driver` cannot be resolved. Did you mean one of the following? [`driver_id`, `is_active`, `user_key`, `full_name`, `vehicle_year`].;
'Project [driver_id#608, user_key#578, full_name#532, vehicle_license_plate#610, vehicle_type#611, vehicle_year#612, is_active#673, effective_start_date#674, effective_end_date#675, row_number() windowspecdefinition('driver ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS driver_key#686]
+- Project [driver_id#608, user_key#578, full_name#532, vehicle_license_plate#610, vehicle_type#611, vehicle_year#612, true AS is_active#673, current_date(Some(Asia/Vientiane)) AS effective_start_date#674, to_date(9999-12-31, None, Some(Asia/Vientiane), false) AS effective_end_date#675]
   +- Project [driver_id#608, user_key#578, full_name#532, vehicle_license_plate#610, vehicle_type#611, vehicle_year#612]
      +- Join Inner, (user_id#609 = user_id#531)
         :- Relation [driver_id#608,user_id#609,vehicle_license_plate#610,vehicle_type#611,vehicle_year#612,dl_ingestion_timestamp#613,dl_source_table#614,dl_batch_id#615,dl_process_date#616] parquet
         +- Project [user_id#531, full_name#532, email#533, phone_number#535, address#536, role#543, created_at#538, is_active#564, effective_start_date#565, effective_end_date#566, user_key#578]
            +- Project [user_id#531, full_name#532, email#533, phone_number#535, address#536, role#543, created_at#538, is_active#564, effective_start_date#565, effective_end_date#566, _w0#580, user_key#578, user_key#578]
               +- Window [row_number() windowspecdefinition(_w0#580 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS user_key#578], [_w0#580 ASC NULLS FIRST]
                  +- Project [user_id#531, full_name#532, email#533, phone_number#535, address#536, role#543, created_at#538, is_active#564, effective_start_date#565, effective_end_date#566, current_user() AS _w0#580]
                     +- Project [user_id#531, full_name#532, email#533, phone_number#535, address#536, role#543, created_at#538, true AS is_active#564, coalesce(cast(created_at#538 as date), current_date(Some(Asia/Vientiane))) AS effective_start_date#565, to_date(9999-12-31, None, Some(Asia/Vientiane), false) AS effective_end_date#566]
                        +- Project [user_id#531, full_name#532, email#533, phone_number#535, address#536, role#543, created_at#538]
                           +- Project [user_id#531, full_name#532, email#533, password_hash#534, phone_number#535, address#536, staticinvoke(class org.apache.spark.sql.catalyst.util.CharVarcharCodegenUtils, StringType, readSidePadding, role#537, 6, true, false, true) AS role#543, created_at#538, dl_ingestion_timestamp#539, dl_source_table#540, dl_batch_id#541, dl_process_date#542]
                              +- Relation [user_id#531,full_name#532,email#533,password_hash#534,phone_number#535,address#536,role#537,created_at#538,dl_ingestion_timestamp#539,dl_source_table#540,dl_batch_id#541,dl_process_date#542] parquet

2024-12-24 16:50:50,841 - __main__ - ERROR - Pipeline failed: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `driver` cannot be resolved. Did you mean one of the following? [`driver_id`, `is_active`, `user_key`, `full_name`, `vehicle_year`].;
'Project [driver_id#608, user_key#578, full_name#532, vehicle_license_plate#610, vehicle_type#611, vehicle_year#612, is_active#673, effective_start_date#674, effective_end_date#675, row_number() windowspecdefinition('driver ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS driver_key#686]
+- Project [driver_id#608, user_key#578, full_name#532, vehicle_license_plate#610, vehicle_type#611, vehicle_year#612, true AS is_active#673, current_date(Some(Asia/Vientiane)) AS effective_start_date#674, to_date(9999-12-31, None, Some(Asia/Vientiane), false) AS effective_end_date#675]
   +- Project [driver_id#608, user_key#578, full_name#532, vehicle_license_plate#610, vehicle_type#611, vehicle_year#612]
      +- Join Inner, (user_id#609 = user_id#531)
         :- Relation [driver_id#608,user_id#609,vehicle_license_plate#610,vehicle_type#611,vehicle_year#612,dl_ingestion_timestamp#613,dl_source_table#614,dl_batch_id#615,dl_process_date#616] parquet
         +- Project [user_id#531, full_name#532, email#533, phone_number#535, address#536, role#543, created_at#538, is_active#564, effective_start_date#565, effective_end_date#566, user_key#578]
            +- Project [user_id#531, full_name#532, email#533, phone_number#535, address#536, role#543, created_at#538, is_active#564, effective_start_date#565, effective_end_date#566, _w0#580, user_key#578, user_key#578]
               +- Window [row_number() windowspecdefinition(_w0#580 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS user_key#578], [_w0#580 ASC NULLS FIRST]
                  +- Project [user_id#531, full_name#532, email#533, phone_number#535, address#536, role#543, created_at#538, is_active#564, effective_start_date#565, effective_end_date#566, current_user() AS _w0#580]
                     +- Project [user_id#531, full_name#532, email#533, phone_number#535, address#536, role#543, created_at#538, true AS is_active#564, coalesce(cast(created_at#538 as date), current_date(Some(Asia/Vientiane))) AS effective_start_date#565, to_date(9999-12-31, None, Some(Asia/Vientiane), false) AS effective_end_date#566]
                        +- Project [user_id#531, full_name#532, email#533, phone_number#535, address#536, role#543, created_at#538]
                           +- Project [user_id#531, full_name#532, email#533, password_hash#534, phone_number#535, address#536, staticinvoke(class org.apache.spark.sql.catalyst.util.CharVarcharCodegenUtils, StringType, readSidePadding, role#537, 6, true, false, true) AS role#543, created_at#538, dl_ingestion_timestamp#539, dl_source_table#540, dl_batch_id#541, dl_process_date#542]
                              +- Relation [user_id#531,full_name#532,email#533,password_hash#534,phone_number#535,address#536,role#537,created_at#538,dl_ingestion_timestamp#539,dl_source_table#540,dl_batch_id#541,dl_process_date#542] parquet

2024-12-24 16:50:50,844 - py4j.clientserver - INFO - Closing down clientserver connection
