2024-12-24 23:34:43,691 - __main__ - INFO - Starting logistics data pipeline
User: ponydasierra
Environment: development
Start Time (UTC): 2024-12-24 16:34:40.899128
2024-12-24 23:34:43,691 - __main__ - INFO - Starting data extraction phase
2024-12-24 23:34:43,691 - __main__ - INFO - Processing table: Orders
2024-12-24 23:34:43,691 - src.extract.mysql_extractor - INFO - Starting extraction of table Orders
2024-12-24 23:34:46,191 - src.extract.mysql_extractor - INFO - Completed extraction of Orders:
Records: 5,000
Partitions: 4
Duration: 2.10 seconds
2024-12-24 23:34:46,303 - src.load.datalake_loader - INFO - Starting raw zone load for Orders
2024-12-24 23:34:47,473 - src.load.datalake_loader - INFO - Completed raw zone load for Orders:
Records: 5,000
Partitioning: partitioned by ['created_at_partition', 'status']
Duration: 1.11 seconds
Path: hdfs://localhost:9000/user/thuanpony03/logistics/data/datalake/raw/Orders
2024-12-24 23:34:47,473 - __main__ - INFO - Completed Orders: 5,000 records processed in 3.78 seconds
2024-12-24 23:34:47,473 - __main__ - INFO - Processing table: Shipments
2024-12-24 23:34:47,473 - src.extract.mysql_extractor - INFO - Starting extraction of table Shipments
2024-12-24 23:34:47,600 - src.extract.mysql_extractor - INFO - Completed extraction of Shipments:
Records: 3,756
Partitions: 4
Duration: 0.04 seconds
2024-12-24 23:34:47,651 - src.load.datalake_loader - INFO - Starting raw zone load for Shipments
2024-12-24 23:34:48,305 - src.load.datalake_loader - INFO - Completed raw zone load for Shipments:
Records: 3,756
Partitioning: partitioned by ['status']
Duration: 0.61 seconds
Path: hdfs://localhost:9000/user/thuanpony03/logistics/data/datalake/raw/Shipments
2024-12-24 23:34:48,305 - __main__ - INFO - Completed Shipments: 3,756 records processed in 0.83 seconds
2024-12-24 23:34:48,305 - __main__ - INFO - Processing table: Payments
2024-12-24 23:34:48,305 - src.extract.mysql_extractor - INFO - Starting extraction of table Payments
2024-12-24 23:34:48,400 - src.extract.mysql_extractor - INFO - Completed extraction of Payments:
Records: 5,000
Partitions: 4
Duration: 0.04 seconds
2024-12-24 23:34:48,474 - src.load.datalake_loader - INFO - Starting raw zone load for Payments
2024-12-24 23:34:49,113 - src.load.datalake_loader - INFO - Completed raw zone load for Payments:
Records: 5,000
Partitioning: partitioned by ['payment_date_partition', 'payment_status']
Duration: 0.60 seconds
Path: hdfs://localhost:9000/user/thuanpony03/logistics/data/datalake/raw/Payments
2024-12-24 23:34:49,114 - __main__ - INFO - Completed Payments: 5,000 records processed in 0.81 seconds
2024-12-24 23:34:49,114 - __main__ - INFO - Processing table: Notifications
2024-12-24 23:34:49,114 - src.extract.mysql_extractor - INFO - Starting extraction of table Notifications
2024-12-24 23:34:49,192 - src.extract.mysql_extractor - INFO - Completed extraction of Notifications:
Records: 3,756
Partitions: 4
Duration: 0.03 seconds
2024-12-24 23:34:49,234 - src.load.datalake_loader - INFO - Starting raw zone load for Notifications
2024-12-24 23:34:49,438 - src.load.datalake_loader - INFO - Completed raw zone load for Notifications:
Records: 3,756
Partitioning: partitioned by ['notification_date_partition']
Duration: 0.16 seconds
Path: hdfs://localhost:9000/user/thuanpony03/logistics/data/datalake/raw/Notifications
2024-12-24 23:34:49,438 - __main__ - INFO - Completed Notifications: 3,756 records processed in 0.32 seconds
2024-12-24 23:34:49,438 - __main__ - INFO - Processing table: Users
2024-12-24 23:34:49,438 - src.extract.mysql_extractor - INFO - Starting extraction of table Users
2024-12-24 23:34:49,493 - src.extract.mysql_extractor - INFO - Completed extraction of Users:
Records: 1,000
Partitions: 1
Duration: 0.01 seconds
2024-12-24 23:34:49,526 - src.load.datalake_loader - INFO - Starting raw zone load for Users
2024-12-24 23:34:49,648 - src.load.datalake_loader - INFO - Completed raw zone load for Users:
Records: 1,000
Partitioning: not partitioned
Duration: 0.09 seconds
Path: hdfs://localhost:9000/user/thuanpony03/logistics/data/datalake/raw/Users
2024-12-24 23:34:49,648 - __main__ - INFO - Completed Users: 1,000 records processed in 0.21 seconds
2024-12-24 23:34:49,648 - __main__ - INFO - Processing table: Drivers
2024-12-24 23:34:49,648 - src.extract.mysql_extractor - INFO - Starting extraction of table Drivers
2024-12-24 23:34:49,706 - src.extract.mysql_extractor - INFO - Completed extraction of Drivers:
Records: 200
Partitions: 1
Duration: 0.01 seconds
2024-12-24 23:34:49,760 - src.load.datalake_loader - INFO - Starting raw zone load for Drivers
2024-12-24 23:34:49,876 - src.load.datalake_loader - INFO - Completed raw zone load for Drivers:
Records: 200
Partitioning: not partitioned
Duration: 0.08 seconds
Path: hdfs://localhost:9000/user/thuanpony03/logistics/data/datalake/raw/Drivers
2024-12-24 23:34:49,876 - __main__ - INFO - Completed Drivers: 200 records processed in 0.23 seconds
2024-12-24 23:34:49,876 - __main__ - INFO - Data extraction phase completed in 6.19 seconds
2024-12-24 23:34:49,876 - __main__ - INFO - Starting data transformation phase
2024-12-24 23:34:49,876 - src.transform.transform_executor - INFO - Starting transformation process
Timestamp: 2024-12-24 09:43:35
User: thuanpony03
2024-12-24 23:34:49,876 - src.transform.transform_executor - INFO - Starting dimension transformation at 2024-12-24 09:43:35
2024-12-24 23:34:49,876 - src.transform.dimension_builder - INFO - Building date dimension from 2024-01-01 to 2024-12-31
2024-12-24 23:34:50,711 - src.transform.dimension_builder - INFO - Successfully built date dimension with 366 rows
2024-12-24 23:34:50,948 - src.transform.dimension_builder - INFO - Building user dimension
2024-12-24 23:34:51,120 - src.transform.dimension_builder - INFO - Successfully built user dimension with 1000 rows
2024-12-24 23:34:51,120 - src.transform.dimension_builder - INFO - Building driver dimension
2024-12-24 23:34:51,403 - src.transform.dimension_builder - INFO - Successfully built driver dimension with 200 rows
2024-12-24 23:34:51,417 - src.transform.dimension_builder - INFO - Building location dimension
2024-12-24 23:34:53,426 - src.transform.dimension_builder - INFO - Successfully built location dimension with 13756 unique addresses
2024-12-24 23:34:53,695 - src.transform.dimension_builder - INFO - Building payment method dimension
2024-12-24 23:34:55,519 - src.transform.dimension_builder - INFO - Successfully built payment method dimension with 3 rows
2024-12-24 23:34:58,343 - src.transform.transform_executor - INFO - Completed dimension transformation with counts:
date: 366 rows
user: 1000 rows
driver: 200 rows
location: 13756 rows
payment_method: 3 rows
2024-12-24 23:34:58,343 - src.transform.transform_executor - INFO - Starting fact transformation at 2024-12-24 09:43:35
2024-12-24 23:34:58,458 - src.transform.fact_builder - INFO - Building orders fact table
2024-12-24 23:34:58,650 - src.transform.fact_builder - ERROR - Error building orders fact table: [AMBIGUOUS_REFERENCE] Reference `driver_id` is ambiguous, could be: [`driver_id`, `driver_id`].
2024-12-24 23:34:58,652 - src.transform.transform_executor - ERROR - Error in fact transformation: [AMBIGUOUS_REFERENCE] Reference `driver_id` is ambiguous, could be: [`driver_id`, `driver_id`].
2024-12-24 23:34:58,655 - src.transform.transform_executor - ERROR - Transform process failed: [AMBIGUOUS_REFERENCE] Reference `driver_id` is ambiguous, could be: [`driver_id`, `driver_id`].
2024-12-24 23:34:58,658 - __main__ - ERROR - Error in transformation phase: [AMBIGUOUS_REFERENCE] Reference `driver_id` is ambiguous, could be: [`driver_id`, `driver_id`].
2024-12-24 23:34:58,659 - __main__ - ERROR - Pipeline failed: [AMBIGUOUS_REFERENCE] Reference `driver_id` is ambiguous, could be: [`driver_id`, `driver_id`].
2024-12-24 23:34:58,662 - py4j.clientserver - INFO - Closing down clientserver connection
