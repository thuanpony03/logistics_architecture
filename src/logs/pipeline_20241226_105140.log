2024-12-26 17:51:41,120 - __main__ - INFO - Starting logistics data pipeline
User: ponydasierra
Environment: development
Start Time (UTC): 2024-12-26 10:51:38.216403
2024-12-26 17:51:41,120 - __main__ - INFO - Starting data extraction phase
2024-12-26 17:51:41,120 - __main__ - INFO - Processing table: Orders
2024-12-26 17:51:41,120 - src.extract.mysql_extractor - INFO - Starting extraction of table Orders
2024-12-26 17:51:43,574 - src.extract.mysql_extractor - INFO - Completed extraction of Orders:
Records: 5,000
Partitions: 4
Duration: 2.06 seconds
2024-12-26 17:51:43,683 - src.load.datalake_loader - INFO - Starting raw zone load for Orders
2024-12-26 17:51:44,842 - src.load.datalake_loader - INFO - Completed raw zone load for Orders:
Records: 5,000
Partitioning: partitioned by ['created_at_partition', 'status']
Duration: 1.09 seconds
Path: hdfs://localhost:9000/user/thuanpony03/logistics/data/datalake/raw/Orders
2024-12-26 17:51:44,843 - __main__ - INFO - Completed Orders: 5,000 records processed in 3.72 seconds
2024-12-26 17:51:44,843 - __main__ - INFO - Processing table: Shipments
2024-12-26 17:51:44,843 - src.extract.mysql_extractor - INFO - Starting extraction of table Shipments
2024-12-26 17:51:44,974 - src.extract.mysql_extractor - INFO - Completed extraction of Shipments:
Records: 3,756
Partitions: 4
Duration: 0.04 seconds
2024-12-26 17:51:45,024 - src.load.datalake_loader - INFO - Starting raw zone load for Shipments
2024-12-26 17:51:45,272 - src.load.datalake_loader - INFO - Completed raw zone load for Shipments:
Records: 3,756
Partitioning: partitioned by ['status']
Duration: 0.20 seconds
Path: hdfs://localhost:9000/user/thuanpony03/logistics/data/datalake/raw/Shipments
2024-12-26 17:51:45,272 - __main__ - INFO - Completed Shipments: 3,756 records processed in 0.43 seconds
2024-12-26 17:51:45,272 - __main__ - INFO - Processing table: Payments
2024-12-26 17:51:45,272 - src.extract.mysql_extractor - INFO - Starting extraction of table Payments
2024-12-26 17:51:45,377 - src.extract.mysql_extractor - INFO - Completed extraction of Payments:
Records: 5,000
Partitions: 4
Duration: 0.04 seconds
2024-12-26 17:51:45,431 - src.load.datalake_loader - INFO - Starting raw zone load for Payments
2024-12-26 17:51:46,087 - src.load.datalake_loader - INFO - Completed raw zone load for Payments:
Records: 5,000
Partitioning: partitioned by ['payment_date_partition', 'payment_status']
Duration: 0.62 seconds
Path: hdfs://localhost:9000/user/thuanpony03/logistics/data/datalake/raw/Payments
2024-12-26 17:51:46,087 - __main__ - INFO - Completed Payments: 5,000 records processed in 0.82 seconds
2024-12-26 17:51:46,087 - __main__ - INFO - Processing table: Notifications
2024-12-26 17:51:46,087 - src.extract.mysql_extractor - INFO - Starting extraction of table Notifications
2024-12-26 17:51:46,165 - src.extract.mysql_extractor - INFO - Completed extraction of Notifications:
Records: 3,756
Partitions: 4
Duration: 0.03 seconds
2024-12-26 17:51:46,207 - src.load.datalake_loader - INFO - Starting raw zone load for Notifications
2024-12-26 17:51:46,798 - src.load.datalake_loader - INFO - Completed raw zone load for Notifications:
Records: 3,756
Partitioning: partitioned by ['notification_date_partition']
Duration: 0.55 seconds
Path: hdfs://localhost:9000/user/thuanpony03/logistics/data/datalake/raw/Notifications
2024-12-26 17:51:46,798 - __main__ - INFO - Completed Notifications: 3,756 records processed in 0.71 seconds
2024-12-26 17:51:46,798 - __main__ - INFO - Processing table: Users
2024-12-26 17:51:46,798 - src.extract.mysql_extractor - INFO - Starting extraction of table Users
2024-12-26 17:51:46,854 - src.extract.mysql_extractor - INFO - Completed extraction of Users:
Records: 1,000
Partitions: 1
Duration: 0.01 seconds
2024-12-26 17:51:46,889 - src.load.datalake_loader - INFO - Starting raw zone load for Users
2024-12-26 17:51:47,025 - src.load.datalake_loader - INFO - Completed raw zone load for Users:
Records: 1,000
Partitioning: not partitioned
Duration: 0.10 seconds
Path: hdfs://localhost:9000/user/thuanpony03/logistics/data/datalake/raw/Users
2024-12-26 17:51:47,026 - __main__ - INFO - Completed Users: 1,000 records processed in 0.23 seconds
2024-12-26 17:51:47,026 - __main__ - INFO - Processing table: Drivers
2024-12-26 17:51:47,026 - src.extract.mysql_extractor - INFO - Starting extraction of table Drivers
2024-12-26 17:51:47,084 - src.extract.mysql_extractor - INFO - Completed extraction of Drivers:
Records: 200
Partitions: 1
Duration: 0.01 seconds
2024-12-26 17:51:47,125 - src.load.datalake_loader - INFO - Starting raw zone load for Drivers
2024-12-26 17:51:47,257 - src.load.datalake_loader - INFO - Completed raw zone load for Drivers:
Records: 200
Partitioning: not partitioned
Duration: 0.08 seconds
Path: hdfs://localhost:9000/user/thuanpony03/logistics/data/datalake/raw/Drivers
2024-12-26 17:51:47,257 - __main__ - INFO - Completed Drivers: 200 records processed in 0.23 seconds
2024-12-26 17:51:47,257 - __main__ - INFO - Data extraction phase completed in 6.14 seconds
2024-12-26 17:51:47,257 - __main__ - INFO - Starting data transformation phase
2024-12-26 17:51:47,257 - src.transform.transform_executor - INFO - Starting transformation process
Timestamp: 2024-12-24 09:43:35
User: thuanpony03
2024-12-26 17:51:47,257 - src.transform.transform_executor - INFO - Starting dimension transformation at 2024-12-24 09:43:35
2024-12-26 17:51:47,257 - src.transform.dimension_builder - INFO - Building date dimension from 2024-01-01 to 2024-12-31
2024-12-26 17:51:48,097 - src.transform.dimension_builder - INFO - Successfully built date dimension with 366 rows
2024-12-26 17:51:48,342 - src.transform.dimension_builder - INFO - Building user dimension
2024-12-26 17:51:48,538 - src.transform.dimension_builder - INFO - Successfully built user dimension with 1000 rows
2024-12-26 17:51:48,538 - src.transform.dimension_builder - INFO - Building driver dimension
2024-12-26 17:51:48,867 - src.transform.dimension_builder - INFO - Successfully built driver dimension with 200 rows
2024-12-26 17:51:48,879 - src.transform.dimension_builder - INFO - Building location dimension
2024-12-26 17:51:50,290 - src.transform.dimension_builder - INFO - Successfully built location dimension with 10000 unique addresses
2024-12-26 17:51:51,662 - src.transform.transform_executor - INFO - Completed dimension transformation with counts:
date: 366 rows
user: 1000 rows
driver: 200 rows
location: 10000 rows
2024-12-26 17:51:51,662 - src.transform.transform_executor - INFO - Starting fact transformation at 2024-12-24 09:43:35
2024-12-26 17:51:51,771 - src.transform.fact_builder - INFO - Building orders fact table
2024-12-26 17:51:52,191 - src.transform.fact_builder - INFO - Successfully built orders fact table with 5000 rows
Time range: Row(min(order_created_at)=datetime.datetime(2024, 12, 24, 20, 0, 14), max(order_created_at)=datetime.datetime(2024, 12, 24, 20, 3, 16))
2024-12-26 17:51:52,200 - src.transform.fact_builder - INFO - Building shipment tracking fact table
2024-12-26 17:51:52,627 - src.transform.fact_builder - INFO - Successfully built shipment tracking fact table with 3756 rows
2024-12-26 17:51:53,512 - src.transform.transform_executor - INFO - Completed fact transformation
Built facts: ['orders', 'shipment_tracking']
Counts: {'orders': 5000, 'shipment_tracking': 3756}
2024-12-26 17:51:53,512 - src.transform.transform_executor - INFO - Saving transformed tables to processed zone
2024-12-26 17:51:53,644 - src.load.datalake_loader - INFO - Completed processed zone load for dim_date:
Records: 366
Update Type: overwrite
Duration: 0.09 seconds
2024-12-26 17:51:53,819 - src.load.datalake_loader - INFO - Completed processed zone load for dim_user:
Records: 1,000
Update Type: overwrite
Duration: 0.14 seconds
2024-12-26 17:51:54,035 - src.load.datalake_loader - INFO - Completed processed zone load for dim_driver:
Records: 200
Update Type: overwrite
Duration: 0.13 seconds
2024-12-26 17:51:56,545 - src.load.datalake_loader - INFO - Completed processed zone load for dim_location:
Records: 10,000
Update Type: overwrite
Duration: 1.61 seconds
2024-12-26 17:51:58,651 - src.load.datalake_loader - INFO - Completed processed zone load for fact_orders:
Records: 5,000
Update Type: append
Duration: 2.00 seconds
2024-12-26 17:51:59,626 - src.load.datalake_loader - INFO - Completed processed zone load for fact_shipment_tracking:
Records: 3,756
Update Type: append
Duration: 0.73 seconds
2024-12-26 17:51:59,626 - src.transform.transform_executor - INFO - Successfully saved all transformed tables
2024-12-26 17:51:59,631 - src.transform.transform_executor - INFO - Completed transformation process
Duration: 176904.00 seconds
2024-12-26 17:52:05,812 - src.transform.transform_executor - INFO - Transform metrics generated:
Duration: 176904.00 seconds
Dimensions processed: 4
Facts processed: 2
Total errors: 0
2024-12-26 17:52:05,812 - __main__ - INFO - Data transformation phase completed in 18.56 seconds
2024-12-26 17:52:05,812 - __main__ - INFO - Starting warehouse loading phase
2024-12-26 17:52:05,824 - src.load.warehouse_loader - INFO - Loading dimension table: dim_date
2024-12-26 17:52:06,252 - src.load.warehouse_loader - INFO - Loaded 366 records into dim_date in 0.43 seconds
2024-12-26 17:52:06,252 - src.load.warehouse_loader - INFO - Loading dimension table: dim_user
2024-12-26 17:52:06,579 - src.load.warehouse_loader - INFO - Loaded 1,000 records into dim_user in 0.33 seconds
2024-12-26 17:52:06,579 - src.load.warehouse_loader - INFO - Loading dimension table: dim_driver
2024-12-26 17:52:06,889 - src.load.warehouse_loader - INFO - Loaded 200 records into dim_driver in 0.31 seconds
2024-12-26 17:52:06,889 - src.load.warehouse_loader - INFO - Loading dimension table: dim_location
2024-12-26 17:52:09,986 - src.load.warehouse_loader - INFO - Loaded 10,000 records into dim_location in 3.10 seconds
2024-12-26 17:52:09,986 - src.load.warehouse_loader - INFO - Loading fact table: fact_orders
2024-12-26 17:52:11,882 - src.load.warehouse_loader - INFO - Loaded 5,000 records into fact_orders in 1.90 seconds
2024-12-26 17:52:11,882 - src.load.warehouse_loader - INFO - Loading fact table: fact_shipment_tracking
2024-12-26 17:52:12,575 - src.load.warehouse_loader - INFO - Loaded 3,756 records into fact_shipment_tracking in 0.69 seconds
2024-12-26 17:52:12,576 - __main__ - INFO - Warehouse loading completed in 6.76 seconds
2024-12-26 17:52:12,576 - __main__ - INFO - Pipeline completed successfully in 34.36 seconds
2024-12-26 17:52:12,579 - py4j.clientserver - INFO - Closing down clientserver connection
