2024-12-24 14:51:09,697 - __main__ - INFO - Starting logistics data pipeline
User: ponydasierra
Environment: development
Start Time (UTC): 2024-12-24 07:51:05.708985
2024-12-24 14:51:09,697 - __main__ - INFO - Starting data extraction phase
2024-12-24 14:51:09,697 - __main__ - INFO - Processing table: Orders
2024-12-24 14:51:09,697 - src.extract.mysql_extractor - INFO - Starting extraction of table Orders
2024-12-24 14:51:12,608 - src.extract.mysql_extractor - INFO - Completed extraction of Orders:
Records: 5,168
Partitions: 4
Duration: 2.51 seconds
2024-12-24 14:51:12,720 - src.load.datalake_loader - INFO - Starting raw zone load for Orders
2024-12-24 14:52:57,625 - py4j.clientserver - INFO - Error while receiving.
Traceback (most recent call last):
  File "/home/ponydasierra/projects/logistics_data_pipeline/.venv/lib/python3.12/site-packages/py4j/clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
                          ^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: reentrant call inside <_io.BufferedReader name=3>
2024-12-24 14:52:57,626 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-24 14:52:57,626 - root - ERROR - Exception while sending command.
Traceback (most recent call last):
  File "/home/ponydasierra/projects/logistics_data_pipeline/.venv/lib/python3.12/site-packages/py4j/clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
                          ^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: reentrant call inside <_io.BufferedReader name=3>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ponydasierra/projects/logistics_data_pipeline/.venv/lib/python3.12/site-packages/py4j/java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ponydasierra/projects/logistics_data_pipeline/.venv/lib/python3.12/site-packages/py4j/clientserver.py", line 539, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending or receiving
2024-12-24 14:52:57,627 - py4j.clientserver - INFO - Error while receiving.
Traceback (most recent call last):
  File "/home/ponydasierra/projects/logistics_data_pipeline/.venv/lib/python3.12/site-packages/py4j/clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
                          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/socket.py", line 707, in readinto
    return self._sock.recv_into(b)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ponydasierra/projects/logistics_data_pipeline/.venv/lib/python3.12/site-packages/pyspark/context.py", line 381, in signal_handler
    self.cancelAllJobs()
  File "/home/ponydasierra/projects/logistics_data_pipeline/.venv/lib/python3.12/site-packages/pyspark/context.py", line 2446, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
    ^^^^^^^^^^^^^^
  File "/home/ponydasierra/projects/logistics_data_pipeline/.venv/lib/python3.12/site-packages/py4j/java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
                   ^^^^^^^^^^^^^^^^^
  File "/home/ponydasierra/projects/logistics_data_pipeline/.venv/lib/python3.12/site-packages/pyspark/errors/exceptions/captured.py", line 179, in deco
    return f(*a, **kw)
           ^^^^^^^^^^^
  File "/home/ponydasierra/projects/logistics_data_pipeline/.venv/lib/python3.12/site-packages/py4j/protocol.py", line 334, in get_return_value
    raise Py4JError(
py4j.protocol.Py4JError: An error occurred while calling o42.sc
2024-12-24 14:52:57,629 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-24 14:52:57,629 - root - ERROR - Exception while sending command.
Traceback (most recent call last):
  File "/home/ponydasierra/projects/logistics_data_pipeline/.venv/lib/python3.12/site-packages/py4j/clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
                          ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/socket.py", line 707, in readinto
    return self._sock.recv_into(b)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ponydasierra/projects/logistics_data_pipeline/.venv/lib/python3.12/site-packages/pyspark/context.py", line 381, in signal_handler
    self.cancelAllJobs()
  File "/home/ponydasierra/projects/logistics_data_pipeline/.venv/lib/python3.12/site-packages/pyspark/context.py", line 2446, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
    ^^^^^^^^^^^^^^
  File "/home/ponydasierra/projects/logistics_data_pipeline/.venv/lib/python3.12/site-packages/py4j/java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
                   ^^^^^^^^^^^^^^^^^
  File "/home/ponydasierra/projects/logistics_data_pipeline/.venv/lib/python3.12/site-packages/pyspark/errors/exceptions/captured.py", line 179, in deco
    return f(*a, **kw)
           ^^^^^^^^^^^
  File "/home/ponydasierra/projects/logistics_data_pipeline/.venv/lib/python3.12/site-packages/py4j/protocol.py", line 334, in get_return_value
    raise Py4JError(
py4j.protocol.Py4JError: An error occurred while calling o42.sc

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ponydasierra/projects/logistics_data_pipeline/.venv/lib/python3.12/site-packages/py4j/java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ponydasierra/projects/logistics_data_pipeline/.venv/lib/python3.12/site-packages/py4j/clientserver.py", line 539, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending or receiving
2024-12-24 14:52:57,630 - py4j.clientserver - INFO - Closing down clientserver connection
2024-12-24 14:52:57,630 - src.load.datalake_loader - ERROR - Error loading Orders to raw zone: An error occurred while calling o87.save
2024-12-24 14:52:57,630 - __main__ - ERROR - Failed processing table Orders: An error occurred while calling o87.save
2024-12-24 14:52:57,630 - __main__ - ERROR - Error in extraction phase: An error occurred while calling o87.save
2024-12-24 14:52:57,631 - __main__ - ERROR - Pipeline failed: An error occurred while calling o87.save
2024-12-24 14:52:57,632 - py4j.clientserver - INFO - Closing down clientserver connection
